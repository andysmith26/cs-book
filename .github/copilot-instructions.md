# AI Coding Assistant Instructions for Woodstock CS Book

## Project Overview

This is a SvelteKit-based educational platform for computer science curriculum content. It serves as a "CS book" with interactive skills and coding projects, built with modern web technologies and focused on pedagogical effectiveness.

## Architecture & Data Flow

### Content Structure

- **Skills**: Stored in `/skills/{category}/{skill-name}/index.js` as JavaScript objects with metadata
- **Projects**: Stored in `/projects/{project-name}/index.js` as JavaScript objects with requirements and rubrics
- **Content Index**: Generated by `scripts/build-content-index.mjs` into `static/data/content-index.json`
- **Routes**: Dynamic SvelteKit routes load content via `import.meta.glob()` for JS modules

### Build Process

```bash
npm run build:index  # Generate content index from JS metadata files
npm run build        # Build static site with SvelteKit
```

**Critical**: Always run `npm run build:index` before `npm run build` - the index generation is required for content to appear.

## Content Creation Patterns

### Skill Definition (`/skills/{category}/{name}/index.js`)

```javascript
export const skillName = {
  id: 'category/skill-name', // Must match directory path
  title: 'Human Readable Title',
  category: 'programming|math|oop|web|tooling|ai',
  description: 'Brief description',
  levels: {
    1: 'Basic competency description',
    2: 'Intermediate level',
    3: 'Advanced application',
  },
  prerequisites: ['other/skill/id'], // Array of skill IDs
  status: 'current', // current|draft|deprecated
  learn: {
    explainer: 'HTML content for explanations',
    references: [{ title: 'Link Title', url: 'https://...' }],
  },
  practice: {
    miniTask: 'Small coding exercise',
    projectTask: 'Larger project application',
  },
};
```

### Project Definition (`/projects/{name}/index.js`)

```javascript
export const projectName = {
  id: 'project-slug', // URL slug, no spaces
  title: 'Project Title',
  courseFit: [{ course: 'csa', unit: '09-inheritance' }],
  skillsRequired: [
    { id: 'oop/classes-objects', level: 2 },
    { id: 'programming/conditionals', level: 2 },
  ],
  skillsSuggested: [{ id: 'tooling/git-basics', level: 1 }],
  prerequisites: [
    { type: 'skill', id: 'programming/methods', level: 1 },
  ],
  status: 'current',
  tags: ['java', 'greenfoot', 'oop'],
  timeToComplete: '2-3 weeks',
  difficulty: 'intermediate',
  brief: 'One-sentence description',
  buildSteps: [
    'Design class hierarchy',
    'Implement core behaviors',
    'Add game mechanics',
  ],
  rubric: 'Specific assessment criteria',
  submit: 'GitHub repo, demo video, poster',
};
```

## Development Workflow

### Adding New Content

1. Create directory: `/skills/{category}/{skill-name}/` or `/projects/{project-name}/`
2. Add `index.js` with proper exports (default export preferred)
3. Run `npm run build:index` to update content index
4. Content automatically appears in navigation and search

### Content Dependencies

- Skills reference each other via `prerequisites` arrays
- Projects declare required/suggested skills with level expectations
- Build script automatically generates reverse relationships (`projectsUsing` for skills)

## SvelteKit Patterns

### Routing & Data Loading

- Dynamic routes use `[...path]` catch-all parameters
- Data loading via `import.meta.glob('/skills/**/index.js')` or `/projects/**/index.js`
- Content modules loaded asynchronously with error handling

### State Management

- Svelte 5 runes: `$state`, `$derived`, `$effect` for reactive state
- `LearningProgressStore` class for tracking student progress
- Local storage persistence for learning analytics

### Component Patterns

- Interactive demos built as Svelte components in skill directories
- `PreflightChecklist.svelte` for prerequisite validation
- `FilterBar.svelte` for content filtering
- Layout components (`DefaultLayout.svelte`, `ProjectLayout.svelte`) configured in MDSvex

## Build & Deployment

### Adapters

- Configured for Vercel deployment (`@sveltejs/adapter-vercel`)
- Can switch to static (`@sveltejs/adapter-static`) for GitHub Pages
- Comment/uncomment adapter in `svelte.config.js` as needed

### Development

```bash
npm run dev      # Hot reload development server
npm run preview  # Preview production build locally
```

## Key Conventions

### File Organization

- Content lives outside `src/` in `/skills/` and `/projects/`
- UI components in `src/lib/components/`
- Shared utilities in `src/lib/shared/`
- Page routes in `src/routes/` follow content structure

### Naming & IDs

- Skill IDs: `{category}/{name}` (e.g., `programming/variables`)
- Project IDs: simple slugs (e.g., `asteroids`)
- Directory structure must match ID paths

### Content Status

- `current`: Active content
- `draft`: Work in progress
- `deprecated`: Replaced but kept for reference
- `missing`: Referenced but not yet implemented

## Common Tasks

### Adding a New Skill

1. Create `/skills/{category}/{skill-name}/index.js`
2. Export skill object with required fields
3. Add any interactive components in same directory
4. Run `npm run build:index`

### Adding a New Project

1. Create `/projects/{project-name}/index.js`
2. Export project object with skills alignment
3. Add any interactive components in same directory
4. Run `npm run build:index`

### Updating Dependencies

- Skills automatically get `projectsUsing` field from build script
- Projects can reference skills that don't exist yet (forward compatibility)
- Content index rebuilds all relationships on each build

## Troubleshooting

### Content Not Appearing

- Run `npm run build:index` after adding new content
- Check console for import errors in skill/project JS files
- Verify `id` field matches directory path exactly

### Build Failures

- Ensure all skill/project objects have required fields (`id`, `title`, `category` for skills)
- Check for syntax errors in JS metadata files
- Verify prerequisite references point to valid skill IDs

### Routing Issues

- Dynamic routes expect exact path matches to content directories
- Missing content returns `{ notFound: true }` from load functions
